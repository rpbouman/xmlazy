<!doctype html>
<html>
  <head>
    <title>xmlazy Samples: 04. Reading a stream with the SaxStreamReader</title>
    <script type="text/javascript" src="../3rdparty/emoji-favicon-toolkit.min.js"></script>
    <script type="text/javascript">
      set_emoji_favicon(emoji="ðŸ¦¥", cacheWithServiceWorker = false);
    </script>
    <style type="text/css">
      textarea {
        width: 100%
      }
      
    </style>
  </head>
  <body>
    <h1>ðŸ¦¥ 04. Reading a stream with the SaxStreamReader</h1>
    <a href="../index.html">Back</a>
    <input
      type="file"
      id="fileInput"
      accept=".xml"
    />
    <script type="module">
      import * as xmlazy from '/dist/xmlazy.bundle.js';

      const handleFile = (event) => {
        const fileInput = event.target;
        const files = fileInput.files;
        const file = files[0];
        if (file === undefined) {
          return;
        }
        fileInput.value = '';
        const stream = file.stream();
        const reader = stream.getReader();        
        
        var saxHandler = function(domNode){
          //console.log(domNode.nodeType, domNode.sourceXml);
        }
        
        var saxStreamReader = new xmlazy.SaxStreamReader();
        console.time('Parse');
        saxStreamReader.parseAndCallback({
          saxHandler: saxHandler,
          textDecoder: new TextDecoder('UTF-8'),
          reader: reader
        }).then(function(){
          console.timeEnd('Parse');
        }).catch(function(){
          debugger;
        });
      };


      document.getElementById('fileInput').onchange = handleFile;
    </script>
  </body>
</html>